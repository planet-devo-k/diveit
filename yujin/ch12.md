# 🚀 모던 웹 성능 최적화 및 핵심 지표(Core Web Vitals) 심층 가이드

## 1. 웹사이트 성능과 비즈니스의 상관관계

웹사이트의 성능은 단순한 기술적 지표를 넘어 **사용자 경험(UX)**과 **직접적인 비즈니스 수익**으로 직결됩니다.

### 성능이 곧 수익인 이유

* **전환율(Conversion Rate):** 1초 내로 로딩되는 사이트는 5초 내로 로딩되는 사이트보다 전자상거래 전환율이 약 **2.5배** 높습니다. 로딩이 1초 지연될 때마다 전환율은 약 **4.42%**씩 하락하며, 5초를 넘기면 이탈률이 급격히 증가합니다.
* **사용자 인지 속도:** 소비자의 70%는 페이지 속도가 방문 여부에 영향을 미친다고 답했으며, 절반 이상은 빠른 속도를 위해서라면 화려한 애니메이션이나 동영상조차 포기할 의사가 있다고 밝혔습니다.
* **모바일 이탈률:** 구글의 분석에 따르면, 로딩 시간이 1초에서 10초로 늘어날 때 모바일 사용자의 이탈 확률은 **123%** 증가합니다.

### 왜 여전히 웹사이트는 느린가?

기능과 하드웨어는 발전했지만 웹은 더 무거워졌습니다.

1. **리소스의 비대화:** 웹사이트가 화려해지면서 고해상도 이미지, 자바스크립트 프레임워크, 타사 스크립트(광고, 분석 도구)가 기하급수적으로 늘어났습니다.
2. **개발 환경의 괴리:** 개발자는 대게 고성능 기기와 안정적인 기가비트 네트워크에서 작업하므로, 저사양 기기와 불안정한 네트워크를 사용하는 일반 사용자의 고통을 체감하기 어렵습니다.
3. **최적화의 어려움:** 성능 개선은 한두 가지 코드 수정으로 끝나지 않는 **종합적인 엔지니어링** 과정입니다.

---

## 2. 최대 콘텐츠풀 페인트 (LCP: Largest Contentful Paint)

![alt text](image-4.png)

LCP는 사용자가 페이지를 방문했을 때 **"가장 중요한 콘텐츠가 얼마나 빨리 뜨는가"**를 측정하는 지표입니다.

### 정의 및 측정 대상

* **정의:** 페이지 로드 시작부터 뷰포트(현재 보이는 화면) 내에서 가장 큰 이미지나 텍스트 블록이 렌더링될 때까지의 시간입니다.
* **주요 요소:** `<img>`, `<video>`의 poster 이미지, `background-image: url()`이 적용된 요소, 텍스트를 포함한 블록 레벨 요소(`<div>`, `<h1>`, `<p>`) 등이 대상이 됩니다.

### 성능 개선 방안

* **텍스트 우선 정책:** 가장 확실한 방법은 첫 화면(Above the Fold)의 메인 영역에 이미지 대신 텍스트를 배치하는 것입니다. 텍스트는 추가 리소스 요청 없이 HTML 파싱과 동시에 렌더링됩니다.
* **이미지 로딩 최적화:**
* **프리로드 스캐너 활용:** `<img>` 태그는 브라우저가 HTML을 읽으며 즉시 발견해 병렬 다운로드합니다. 반면 CSS의 `background-image`나 `<svg>` 내부 이미지는 발견이 늦어 LCP 점수에 불리합니다.
* **비디오 포스터 활용:** `<video>` 태그 사용 시 실제 영상을 다 받기 전 썸네일 역할을 하는 `poster` 속성을 반드시 지정하십시오.
* **이미지 포맷 혁신:** PNG 대비 26%, JPG 대비 최대 34% 가벼운 **WebP** 형식을 도입하고, 무손실/손실 압축 모드를 적절히 선택하십시오.


* **로딩 지연 방지:**
* **LCP 이미지에 `loading=lazy` 금지:** 중요하지 않은 이미지에는 유용하지만, LCP 대상 이미지에 적용하면 로딩이 시작되는 시점 자체가 늦어져 점수가 깎입니다.
* **직접 호스팅:** Cloudinary 같은 외부 CDN 서비스를 사용하더라도, 가장 중요한 메인 리소스는 현재 도메인(Same Origin)에서 직접 제공하여 DNS 조회 및 연결 시간을 아끼는 것이 좋습니다.



---

## 3. 최초 입력 지연(FID)과 상호작용 페인트(INP)

웹사이트가 단순히 보이기만 하는 것을 넘어 **"얼마나 기민하게 반응하는가"**에 대한 지표입니다.

### FID (First Input Delay) - 과거의 기준

* **정의:** 사용자가 처음 클릭이나 탭을 했을 때, 브라우저가 그 이벤트를 처리하기 시작할 때까지의 대기 시간입니다.
* **한계:** 첫 번째 상호작용만 측정하므로, 그 이후 페이지가 버벅이는 현상은 잡아내지 못합니다.

### INP (Interaction to Next Paint) - 현재의 정식 지표 (2024년 3월 대체)

* **차이점:** FID가 '인식 시작'만 쟀다면, INP는 **'사용자의 행동'부터 '화면이 실제로 바뀔 때'까지의 전체 시간**을 잽니다. 또한 페이지 체류 시간 내 발생하는 **모든 상호작용**을 감시하여 가장 느린 케이스를 점수화합니다.

### 반응성 개선 전략 (FID & INP 공통)

* **메인 스레드 확보:** 자바스크립트는 싱글 스레드입니다. 긴 작업(Long Task, 50ms 이상)이 스레드를 점유하면 사용자의 입력은 무시됩니다.
* **코드 분할(Code Splitting):** 큰 JS 파일을 작은 단위로 쪼개어 필요한 시점에만 로드하십시오.
* **Web Workers:** 복잡한 계산은 백그라운드 스레드로 옮겨 메인 스레드를 비워두십시오.


* **시각적 피드백 즉시 제공:** 복잡한 연산이 끝나기 전이라도 버튼이 눌린 효과나 로딩 스피너를 즉시 그려주십시오. 브라우저는 **화면이 한 번이라도 바뀌는 순간(Next Paint)**을 반응 완료로 간주하기 때문입니다.
* **스크립트 로딩 제어:**
* **`defer` vs `async`:** 타사 스크립트(광고, 분석)는 병렬 다운로드 후 페이지 로드 완료 시 실행되는 `defer`를 사용하는 것이 상호작용 방해를 최소화하는 길입니다.



---

## 4. 누적 레이아웃 이동 (CLS: Cumulative Layout Shift)

사용자가 기사를 읽거나 버튼을 누르려 할 때 화면이 갑자기 툭 튀어나와 위치가 바뀌는 **"시각적 불안정성"**을 측정합니다.

### 원인 및 의미

* **지연 렌더링:** `useEffect`로 나중에 데이터를 받아와서 요소를 추가할 때 발생합니다.
* **폰트 로딩:** 웹 폰트가 늦게 로드되면서 기본 폰트와 크기가 달라 발생하는 **FOUT(Unstyled)**, **FOIT(Invisible)** 현상이 주원인입니다.

### 레이아웃 안정화 방안

* **공간 미리 확보:** 동적으로 들어올 배너나 이미지는 스켈레톤 UI를 사용하거나, CSS로 미리 너비와 높이를 지정해 두십시오.
* **이미지 비율 고정:** `aspect-ratio` 속성을 사용하여 이미지가 로딩되기 전에도 브라우저가 정확한 영역을 차지하게 만드십시오.
```css
img {
  width: 100%;
  height: auto;
  aspect-ratio: 16 / 9; /* 가로세로 비율 강제 */
}

```


* **웹 폰트 최적화:** `<link rel=preload>`를 사용해 폰트를 우선적으로 불러오고, `font-display: optional`을 사용하여 0.1초 내에 로드되지 않으면 기본 폰트를 쓰게 하여 레이아웃 이동을 원천 차단하십시오.

---

## 5. 보조 지표: TTFB와 FCP

핵심 지표는 아니지만, 문제의 근본 원인을 파악하는 데 필수적인 지표입니다.

### 최초 바이트까지의 시간 (TTFB: Time To First Byte)

* **의미:** 브라우저가 서버로부터 첫 데이터를 받기까지 걸리는 시간입니다.
* **최적화:** 서버 사이드 렌더링(SSR) 시 복잡한 DB 쿼리를 최적화하거나, 전 세계 거점 서버(Edge)를 활용하는 **CDN**을 도입하여 물리적 거리를 단축하십시오.

### 최초 콘텐츠풀 페인트 (FCP: First Contentful Paint)

* **의미:** 접속 후 화면에 뭐라도(텍스트든 선이든) 처음 나타나는 시점입니다.
* **최적화:** TTFB를 개선하고, 렌더링을 차단하는(Render-blocking) CSS와 JS 파일을 최소화하십시오.

---

## 💡 성능 최적화 핵심 요약표

| 지표 | 측정 대상 | 핵심 전략 | 목표 점수 |
| --- | --- | --- | --- |
| **LCP** | 로딩 속도 | 이미지 최적화, 서버 렌더링, 프리로드 | 2.5초 이하 |
| **INP** | 반응성 | 긴 작업 분할, 시각적 피드백 우선 제공 | 200ms 이하 |
| **CLS** | 시각적 안정성 | 이미지 비율 고정, 공간 확보, 폰트 최적화 | 0.1 이하 |
| **TTFB** | 서버 응답 | 캐싱, DB 최적화, Edge 서버(CDN) 활용 | 800ms 이하 |

**결론적으로:** 웹 성능은 개발자의 편의가 아닌 **사용자의 인내심**에 맞춰져야 함. `Above the Fold` 영역에 대한 철저한 관리와 자바스크립트 실행 효율화를 통해 사용자가 "이 사이트는 정말 빠르고 믿을 만하다"고 느끼게 만드는 것이 최적화의 궁극적인 목표.