# 1. 크로스 사이트 스크립팅(XSS)

크로스 사이트 스크립팅이란?

웹 애플리케이션에서 가장 많이 보이는 취약점 중 하나로, 웹사이트 개발자가 아닌 제3자가 웹사이트에 악성 스크립트를 삽입해 실행할 수 있는 취약점을 의미한다.

이 취약점은 일반적으로 게시판과 같이 사용자가 입력을 할 수 있고, 이 입력을 다른 사용자에게 보여줄 수 있는 경우에 발생.

```jsx
<p>사용자가 글을 작성했습니다.</p>
<script>
	alert('XSS')
</script>
```

위 글을 방문했을 때 별도의 조치가 없다면 Script도 함께 실행되어 window.alert도 함께 실행될 것. 프론트엔드 개발자와 마찬가지로 script가 실행될 수 있다면 웹사이트 개발자가 할 수 있는 모든 작업을 함꼐 수행할 수 있으며, 쿠키를 획득해 사용자의 로그인 세션 등을 탈취하거나 사용자의 데이터를 변경하는 등 각종 위험성이 있음.

## 1. dangerouslySetInnerHTML prop

특정 브라우저 DOM의 innerHTML을 특정한 내용으로 교체할 수 있는 방법.

## 2. useRef를 활용한 직접 삽입

useRef를 활용하면 직접 DOM에 접근할 수 있으므로 이 DOM에 앞서와 비슷한 방식으로 innerHTML에 보안 취약점이 있는 스크립트를 삽입하면 동일한 문제가 발생.

## 3. 리액트에서 XSS 문제를 피하는 방법

제3자가 삽입할 수 있는 HTML을 안전한 HTML코드로 한번 치환하는 것. 이러한 과정을 새니타이즈(sanitize) 혹은 이스케이프(escape)라고 하는데, 새니타이즈를 직접 구현해 사용하는 등 다양한 방법이 있지만 확실한 방법은 npm에 있는 라이브러리를 사용하는 것

- DOMpurity
- sanitize-html
- js-xss

# 2. getServerSideProps와 서버 컴포넌트를 주의하자

서버에는 일반 사용자에게 노출되면 안되는 정보들이 있기 때문에 브라우저에 정보를 내려줄 때는 조심해야함. getServerSideProps가 반환하는 props 값은 모두 사용자의 HTML에 기록되고, 또한 전역 변수로 등록되어 스크립트로 충분히 접근할 수 있는 보안 위협에 노출되는 값이 됨.

쿠키 전체를 제공하는 것이 아닌 클라이언트에서 필요한 token값만 제한적으로 반환, 이 값이 없을 때 예외 처리할 리다이렉트도 모두 서버에서 처리.

# 3. <a> 태그의 값에 적절한 제한을 둬야 한다

href에 javascript: 로 시작하는 자바스크립트 코드를 넣어둔 경우가 있음. 이는 <a>태그의 기본기능, href로 선언된 URL로 페이지를 이동하는 것을 막고 onClick 이벤트와 같이 별도 이벤트 핸들러만 작동시키기 위한 용도로 주로 사용됨.

```jsx
funciton App() {
	function handleClick() {
		console.log('hello')
	}
	return (
		<>
			<a href="javascript:;" onClick={handleClick}>
				링크
			</a>
		</>
	)
}
```

이렇게 하면 <a>의 href가 작동하지 않아 페이지 이동이 일어나지 않는 대신 onClick의 핸들러만 실행되는 것을 볼 수 있음.

이러한 방식은 마크업 관점에서 안티패턴이라 볼 수 있으며 <a>태그는 반드시 페이지 이동이 있을 때만 사용하는 것이 좋음.

# 4. HTTP 보안 헤더 설정하기

## 1. Strict-Transport-Security

## 2. X-XSS-Protection

## 3. X-Frame-Options

## 4. Permissions-Policy

## 5. X-Content-Type-Options

## 6. Referrer-Policy

## 7. Content-Security-Policy

## 9. 보안헤더 확인하기

https://securityheaders.com/ 방문하기

# 5. 취약점이 있는 패키지의 사용을 피하기

# 6. OWASP Top 10

OWASP(Open Worldwide (web) Application Security Project): 오픈소스 웹 애플리케이션 보안 프로젝트를 의미. 주로 웹에서 발생할 수 있는 정보 노출, 악성 스크립트, 보안 취약점 등을 연구하며 주기적으로 10대 웹 애플리케이션 취약점을 공개하는데 이를 OWASP Top 10이라고 함.
