# 12장 모든 웹 개발자가 관심을 가져야 할 핵심 웹 지표

## 12.1 웹 지표란?

- 구글이 사용자 경험(UX)을 측정하기 위해 정의한 지표입니다.
- 웹사이트의 성능이 이탈률, 전환율 등 비즈니스 지표와 직결된다는 데이터에 기반합니다.
- 코어 웹 바이탈(Core Web Vitals): 구글이 강조하는 가장 핵심적인 세 가지 지표인 LCP, FID, CLS를 의미합니다.

---

## 12.2 LCP (Largest Contentful Paint)

### 정의

- 페이지가 로드될 때 사용자에게 보이는 영역 내에서 가장 큰 이미지나 텍스트 블록이 렌더링되는 시점을 의미합니다.
- 실제 사용자가 느끼는 '로딩 완료 시점'에 가장 가까운 지표입니다.

### 기준

- 좋음(Good): 2.5초 이하
- 개선 필요(Needs Improvement): 4.0초 이하
- 나쁨(Poor): 4.0초 초과

### 개선 방법

- 이미지 최적화: 차세대 이미지 형식(WebP, AVIF) 사용 및 반응형 이미지 처리.
- 프리로드(Preload): 중요한 자원은 <link rel="preload">를 사용하여 우선순위 부여.
- 서버 성능: TTFB(Time to First Byte)를 줄이기 위한 서버 로직 최적화 및 CDN 활용.

---

## 12.3 FID (First Input Delay)

### 정의

- 사용자가 링크 클릭, 버튼 탭 등 첫 상호작용을 한 후, 브라우저가 실제로 그 이벤트에 대한 처리를 시작할 때까지의 대기 시간입니다.
- 페이지의 '응답성'을 측정합니다.

### 기준

- 좋음(Good): 100ms 이하
- 개선 필요(Needs Improvement): 300ms 이하
- 나쁨(Poor): 300ms 초과

### 개선 방법

- 메인 스레드 점유 감소: 자바스크립트의 긴 실행 시간(Long Task)을 최소화.
- 불필요한 코드 제거: 사용하지 않는 타사 스크립트나 코드 제거.
- 웹 워커 활용: 무거운 계산 작업은 백그라운드 스레드로 분리.

> 참고: 2024년 3월부터는 FID가 **INP(Interaction to Next Paint)**로 공식 대체되었습니다. INP는 단일 입력 지연이 아닌 페이지 전체의 모든 인터랙션 지연을 포괄적으로 측정합니다.

---

## 12.4 CLS (Cumulative Layout Shift)

### 정의

- 페이지 로드 중 콘텐츠가 갑자기 이동하면서 발생하는 시각적 불안정성을 측정합니다.
- 버튼이 갑자기 움직여서 엉뚱한 곳을 클릭하게 되는 등의 불편함을 수치화한 것입니다.

### 기준

- 좋음(Good): 0.1 이하
- 개선 필요(Needs Improvement): 0.25 이하
- 나쁨(Poor): 0.25 초과

### 개선 방법

- 크기 명시: 이미지와 비디오 요소에 항상 width와 height를 지정하여 미리 공간 확보.
- 광고 영역 확보: 광고나 위젯이 동적으로 로드될 영역을 고정 크기로 미리 설정.
- 폰트 최적화: 웹 폰트 로드 시 발생하는 레이아웃 이동 방지를 위해 font-display: swap 또는 optional 사용.

---

## 12.5 그 외 주요 지표

### FCP (First Contentful Paint)

- 페이지 방문자가 화면에서 텍스트나 이미지 등 첫 번째 콘텐츠를 보는 데 걸리는 시간입니다.

### TTFB (Time to First Byte)

- 서버가 요청에 대해 첫 번째 데이터를 보내기까지 걸리는 시간입니다. 서버 응답 속도의 척도입니다.

---

## 12.6 웹 지표 측정 도구

1.  Lighthouse: 크롬 개발자 도구 내에서 제공되는 자동화 도구로 성능 점수와 개선 권장 사항을 제공합니다.
2.  PageSpeed Insights: URL 기반 분석 도구로, 실제 사용자 데이터(CrUX)와 실험실 데이터를 모두 보여줍니다.
3.  Search Console: '코어 웹 바이탈' 메뉴를 통해 실제 사용자들의 필드 데이터 추이를 확인할 수 있습니다.
4.  web-vitals 라이브러리: 프론트엔드 코드에서 실시간으로 지표를 수집하고 분석 서버로 전송할 때 유용합니다.

```tsx
import { onLCP, onFID, onCLS, onINP } from "web-vitals";

// 각 지표가 측정될 때마다 실행될 함수
function sendToAnalytics(metric) {
  const body = JSON.stringify(metric);
  // 분석 서버로 전송 (예시: navigator.sendBeacon 사용)
  (navigator.sendBeacon && navigator.sendBeacon("/analytics", body)) ||
    fetch("/analytics", { body, method: "POST", keepalive: true });
}

onLCP(sendToAnalytics);
onFID(sendToAnalytics);
onCLS(sendToAnalytics);
onINP(sendToAnalytics);
```
